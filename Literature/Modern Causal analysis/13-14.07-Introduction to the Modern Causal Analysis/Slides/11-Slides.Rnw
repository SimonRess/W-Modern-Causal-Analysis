% Notwendige Einstellung
  % Tools->Global Options-> Sweave: Weave Rnw files using: knitr
  %                                 Typeset LaTeX into PDF using: pdfLaTeX
  
% Anleitungen: 
  % beamer-Dokumente: http://web.mit.edu/rsi/www/pdfs/beamer-tutorial.pdf
  % Sweave: https://rstudio-pubs-static.s3.amazonaws.com/188117_29a7a382c1884bd98ff54b9c7805613f.html
 
  
%Tell R RStudio the path to latex // put behind "%" before "Compile PDF"
  %If you want RStudio to remember this command each time you start RStudio, you have to add the command to your .Rprofile file.
%Sys.setenv(PATH = paste(Sys.getenv("PATH"), "C:\\Program Files\\MiKTeX 2.9\\miktex\\bin\\x64", sep=.Platform$path.sep))
%Sys.setenv(PATH = paste(Sys.getenv("PATH"), "C:\\Users\\simon/AppData\\Local\\Programs\\MIKTEX 2.9\\miktex\\bin\\x64", sep=.Platform$path.sep))

\documentclass{beamer}
\mode<presentation>{\usetheme{Goettingen}}

%Seitenzahl unten links anzeigen
\defbeamertemplate*{footline}{split theme} 
{% 
  \leavevmode% 
  \hbox{
  \begin{beamercolorbox}[wd=.5\paperwidth,ht=2.5ex,dp=1.125ex,leftskip=.3cm,rightskip=.3cm plus1fil]{title in head/foot}%                                            %selbst eingefügte Zeile 
    \insertframenumber{} / \inserttotalframenumber  %selbst eingefügte Zeile 
  \end{beamercolorbox}}% 
  \vskip0pt% 
} 
 

\usepackage[utf8]{inputenc}
\usepackage{babel} %eigentlich: [ngerman]{babel}
%\usepackage{amsmath} not needed because loaded by mathtools
\usepackage{mathtools} % use of \underbrace{} & \overbrace{} (-> https://ctan.net/obsolete/info/math/voss/mathmode/Mathmode.pdf | Loads amsmath
\usepackage{MnSymbol} % Für Unabhängigkeitssymbol
\usepackage{eurosym} % for \euro -> Euro Symbol

\usepackage{graphicx,grffile} % graphicx: for includegraphics{} // grffile: supports multiple dots and spaces in filenames

%Numbering sections in table of content
\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}[subsections numbered]

\author{Simon Ress}
\institute{Ruhr-Universität Bochum}
\title{International comparison of labour market policies}
\subtitle{Modern Causal Analysis. Rubin Causal Model und Directed Acyclic Graphs} 
\date{21.07.2021}

%Seite mit Chapter Name vor jedem Chapter erstellen
\AtBeginSection[]{
    \begin{frame}
    \vfill
    \centering
    \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{section page}
        \usebeamerfont{title}%
        \textit{Chap. \thesection~}%
                {\color{black} \insertsectionhead}\par%
    \end{beamercolorbox}
    \vfill
    \end{frame}
}

<<Set global chunk options, include=FALSE>>=
#other options: https://yihui.name/knitr/options/

knitr::opts_chunk$set(echo = F,  #Do NOT repeat code in final document
               message = F,  #Do NOT print R messages in document
               warning = F,  #Do NOT print warnings
               fig.width=10, 
               fig.height=6,
               tidy=TRUE)  #Zeilenumbruch, wenn maximale LÃ¤nge Ã¼berschritten ist
               #concordance = TRUE)

options(width=45) #Wie lang darf eine Zeile sein (Für Zeilenumbruch wichtig!)
@



\begin{document}
%\SweaveOpts{concordance=TRUE}

\maketitle

%Inhaltsverzeichnis
\begin{frame}
\frametitle{Content} 
\tableofcontents
\end{frame}


\section{Causal Hypotheses} % Wichtig für Inhaltsverzeichnis


\begin{frame}{“Simple” causal hypotheses}
\textbf{“Simple” causal hypotheses with two feature:}
  \begin{itemize}
    \item Graphic representation of a “simple” hypothesis: causal effect of a feature D on a feature Y
  \end{itemize}
  \begin{figure}
	\centering
	\includegraphics[width=0.7\textwidth]{Graphics/D_on_Y.png}
  \end{figure}
  
  \begin{table}[]
    \begin{tabular}{cc}
    \hline \hline
    \textbf{D}           & \textbf{Y}         \\ \hline
    Treatment variable   & Outcome variable   \\
    Explanatory variable  & Explained variable  \\
    Independent variable & Dependent variable \\ \hline \hline
    \end{tabular}
  \end{table}
  
\end{frame}


\begin{frame}{Criteria for causal inference (D on Y)}
  \begin{enumerate} 
    \item \textbf{Distinct theoretical constructs}: No definitional dependency between D and Y
    \item \textbf{Appropriate operationalizations and measurement} of both features: features $\rightarrow$ variables
    \item \textbf{Theoretical plausibility}: Qualitative explanation ($\rightarrow$ mechanism) of the causal effect necessary; reference to empirical studies not sufficient!
    \item \textbf{Appropriate temporal \underline{order}}: Theoretical justification needed (empirical order not sufficient, since anticipation effects can occur)
    \item \textbf{Appropriate temporal \underline{distance}}: Some effects take time to unfold and some effects weaken over time (theoretical justification needed)
    \item \textbf{Identification of the causal effect}: E.g. by DAG
    \item \textbf{Empirical association}: E.g. by regression analysis
  \end{enumerate}
\end{frame}


\section{The counterfactual causal model} % Wichtig für Inhaltsverzeichnis


\begin{frame}{History and basic idea}
\textbf{History}
  \begin{itemize}
    \item First approaches: John Stuart Mill 1843 \& Gustav Theodor Fechner 1860)
    \item Formal concepts of experimental designs in statistics: Neyman 1923 \& Fisher 1935
    \item Formalized causal analysis: Donald B. Rubin 1974, 1977 \& 1978
  \end{itemize}
\textbf{Basic idea}  
  \begin{itemize}
    \item Focus on the causality concept ''Estimating the causal effect of D on Y''
    \item Based on experimental language: almost any situation can be described in non-experimental context at least as a thought experiment
  \end{itemize}  
\textbf{Other names:}  
  \begin{itemize}
    \item Potential Outcome Model (POM)
    \item Rubin Causal Model (RCM)
    \item Modern Causal Analysis (MCA)
  \end{itemize}   
\end{frame}


\begin{frame}{Definitions of treatment and outcomes}
  \begin{figure}
	\centering
	\includegraphics[width=0.7\textwidth]{Graphics/D_on_Y_names.png}
  \end{figure}
\textbf{Simplified version of a binary “Treatment”:}
  \begin{itemize}
    \item D=1:	Treatment (''Experimental group'')
    \item D=0: No Treatment (''Control group'')
  \end{itemize}
\textit{Note: The binary treatment assumption is a simplistic assumption; There are counterfactual causal models with polytomic treatments (nominal, ordinal, metric).}
\end{frame}


\begin{frame}{Central assumption for outcome Y}
  \begin{figure}
	\centering
	\includegraphics[width=0.7\textwidth]{Graphics/D_on_Y_names.png}
  \end{figure}
Each individual \textbf{i} can be observed in two potential states (depending on a potential treatment), which means that \textbf{two potential outcomes} are conceivable for each person \textbf{i}, regardless of the actual treatment status:
  \begin{itemize}
    \item Y\textsubscript{i}\textsuperscript{0} = potential outcome for person i in the case \underline{without} the treatment
    \item Y\textsubscript{i}\textsuperscript{1} = potential outcome for person i in the case of the treatment
  \end{itemize}
\textit{Note: The outcome is generally viewed as metric, but other scale levels can also be assumed.}
\end{frame}


\begin{frame}{Fundamental problem of causal inference}
\textbf{Fundamental problem of causal inference (Paul W. Holland, 1986):} \\
Y\textsubscript{i}\textsuperscript{0} and Y\textsubscript{i}\textsuperscript{1} can never be observed simultaneously for a \textit{single person i}

\begin{table}[]
\caption{Observability of various potential outcomes}
\begin{tabular}{ccc}
\hline \hline
\textbf{}                     & \textbf{Y\textsubscript{i}\textsuperscript{0}}                                                   & \textbf{Y\textsubscript{i}\textsuperscript{1}}                                                   \\ \hline
\textbf{D\textsubscript{i}=0} & {\color[HTML]{009901} \begin{tabular}[c]{@{}c@{}}Factual  \\ (=observable)\end{tabular}}       & {\color[HTML]{9A0000} \begin{tabular}[c]{@{}c@{}}Counterfactual\\ (=unobservable)\end{tabular}} \\
\textbf{D\textsubscript{i}=1} & {\color[HTML]{9A0000} \begin{tabular}[c]{@{}c@{}}Counterfactual\\ (=unobservable)\end{tabular}} & {\color[HTML]{009901} \begin{tabular}[c]{@{}c@{}}Factual \\ (=observable)\end{tabular}}        \\ \hline \hline
\end{tabular}
\end{table}

\textit{Observation rule: Given the actual state (D), only one potential outcome (Y) can be observed per person}
\end{frame}



\begin{frame}{Example of the problem}
\begin{scriptsize}
\begin{table}[]
\caption{Effect of (high) education on income}
\begin{tabular}{ccc}
\hline \hline
\textbf{}                     & \textbf{Y\textsubscript{i}\textsuperscript{0}}                                                                                                                  & \textbf{Y\textsubscript{i}\textsuperscript{1}}                                                                                                                  \\ \hline
\textbf{D\textsubscript{i}=0} & {\color[HTML]{009901} \begin{tabular}[c]{@{}c@{}}(''What a low-educated person \\ actually earns in \\ a state of low-education'')\end{tabular}}            & {\color[HTML]{9A0000} \begin{tabular}[c]{@{}c@{}}(''What a low-educated person \\ would earn if higher \\ education had been achieved'')\end{tabular}} \\
\textbf{D\textsubscript{i}=1} & {\color[HTML]{9A0000} \begin{tabular}[c]{@{}c@{}}(''What a high-educated person \\ would earn if low \\ education had been achieved'')\end{tabular}} & {\color[HTML]{009901} \begin{tabular}[c]{@{}c@{}}(''What a high-educated person \\ actually earns in \\ a state of high-education'')\end{tabular}}                   \\ \hline \hline
\end{tabular}
\end{table}
\end{scriptsize}
Interpretation (first line): If the person is actually low-educated ($\rightarrow$ no treatment), their income can be observed as if that person were low-educated. But it can never be observed what income this person would have with a higher education.
\end{frame}


\begin{frame}{Impossibility of individual causal effects}
The \textit{individual causal effect} of the treatment on the outcome is defined for each individual as the difference between the two potential outcomes in the treatment and control status (given its actual D):\\
\textbf{Individual causal effect of a person i} = Y\textsubscript{i,D}\textsuperscript{1} - Y\textsubscript{i,D}\textsuperscript{0} \\[1em]
\textit{Implications:} 
  \begin{itemize}
    \item Theoretically the individual causal effect is defined
    \item In reality the individual causal effect can never be observed, because always one of the both components (Y\textsubscript{i}\textsuperscript{1} or Y\textsubscript{i}\textsuperscript{0}) is contra factual ($\rightarrow$ red in the table) and therefore unobservable
  \end{itemize}
\end{frame}


\begin{frame}{Solution: Average causal effects}
As social scientists, we are more interested in \textit{average causal effects} and not in the individual causal effect:

\textbf{Types of average effects:}
  \begin{itemize}
    \item \textit{ATT: Average Treatment Effect on the Treated}
    \item \textit{ATU: Average Treatment Effect on the Untreated}
    \item \textit{ATE: Average Treatment Effect}
  \end{itemize}

\end{frame}

\begin{frame}{Advanced notion of potential outcomes}
\begin{table}[]
\caption{Observability of various potential outcomes}
\begin{tabular}{ccc}
\hline \hline
\textbf{}                     & \textbf{Y\textsuperscript{0}}                                                   & \textbf{Y\textsuperscript{1}}                                                   \\ \hline
\textbf{D\textsubscript{i}=0} & {\color[HTML]{009901} \begin{tabular}[c]{@{}c@{}}E(Y\textsuperscript{0}$\vert$D=0) \\ Factual  \\ (=observable)\end{tabular}}       & {\color[HTML]{9A0000} \begin{tabular}[c]{@{}c@{}}E(Y\textsuperscript{1}$\vert$D=0) \\ Counterfactual\\ (=unobservable)\end{tabular}} \\
\textbf{D\textsubscript{i}=1} & {\color[HTML]{9A0000} \begin{tabular}[c]{@{}c@{}}E(Y\textsuperscript{0}$\vert$D=1) \\ Counterfactual\\ (=unobservable)\end{tabular}} & {\color[HTML]{009901} \begin{tabular}[c]{@{}c@{}}E(Y\textsuperscript{1}$\vert$D=1) \\ Factual \\ (=observable)\end{tabular}}        \\ \hline \hline
\end{tabular}
\end{table}

\vspace{10mm}
\small E() denotes the expected value = \href{https://en.wikipedia.org/wiki/Expected_value}{a generalization of the weighted average}
\end{frame}

\begin{frame}{Description of the concepts: ATT}
The \textit{ATT} is the average causal effect of the treatment on the outcome for people who actually experienced the treatment.
\begin{figure}
\centering
\includegraphics[width=1\textwidth]{Graphics/ATT.png}
\end{figure}
\begin{equation}
ATT = \underbrace{E(Y\textsubscript{i}\textsuperscript{1} \vert D\textsubscript{i}=1)}_\text{observable} - \underbrace{E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=1)}_\text{unobservable}
\end{equation} 

\small\textit{Research designs differ in how the unobservable/counterfactual situation is simulated / estimated.}
\end{frame}


\begin{frame}{Description of the concepts: ATU/ATNT}
The \textit{ATNT} is the average causal effect of the treatment on the outcome for people who didn't experienced the treatment.
\begin{figure}
\centering
\includegraphics[width=1\textwidth]{Graphics/ATNT.png}
\end{figure}
\begin{equation}
ATNT = \underbrace{E(Y\textsubscript{i}\textsuperscript{1} \vert D\textsubscript{i}=0)}_\text{unobservable} - \underbrace{E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=0)}_\text{observable}
\end{equation} 

\small\textit{Research designs differ in how the unobservable/counterfactual situation is simulated / estimated.}
\end{frame}


\begin{frame}{Description of the concepts: ATE}
The \textit{ATE} is the average causal effect of the treatment on the outcome for all persons.
\begin{figure}
\centering
\includegraphics[width=1\textwidth]{Graphics/ATE.png}
\end{figure}
\begin{align*}
ATE &= \pi \times ATT + (1-\pi) \times ATNT \\
&= \pi \times (\underbrace{E(Y\textsubscript{i}\textsuperscript{1} \vert D\textsubscript{i}=1)}_\text{observable} - \underbrace{E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=1)}_\text{unobservable}) \\
&+ (1-\pi) \times \underbrace{E(Y\textsubscript{i}\textsuperscript{1} \vert D\textsubscript{i}=0)}_\text{unobservable} - \underbrace{E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=0)}_\text{observable}
\end{align*}
\end{frame}



\begin{frame}{Example}
\textit{The causal effect of higher education on income} \\[2em]
  \begin{itemize}
    \item \textbf{ATT} = Average causal effect of higher education on income for more high-educated people
    \item \textbf{ATNT} = Average causal effect of higher education on income for low-educated people
   \item \textbf{ATE} = Average causal effect of higher education on income \textit{(across all groups)}
  \end{itemize}
\end{frame}


\section{The naive estimator} % Wichtig für Inhaltsverzeichnis

\begin{frame}{Measurement problem: Counterfactual states}
Data is required for the empirical calculation of the effects. However, because some potential outcomes are counterfactual, it is not possible to calculate any of the average causal effects directly. \\
\textit{Nevertheless, we can only work with the existing data}

\begin{figure}
\centering
\includegraphics[width=0.5\textwidth]{Graphics/ATT.png}
\includegraphics[width=0.5\textwidth]{Graphics/ATNT.png}
\includegraphics[width=0.5\textwidth]{Graphics/ATE.png}
\end{figure}
\end{frame}


\begin{frame}{Limited solution: The naive estimator}
\textbf{Definition}\\
The \textit{naive estimator (NaivE)} is the difference between the factual (observable) outcomes
\begin{align*}
NaivE = \underbrace{E(Y\textsubscript{i}\textsuperscript{1} \vert D\textsubscript{i}=1)}_\text{observable} - \underbrace{E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=0)}_\text{observable}
\end{align*}
\begin{figure}
\centering
\includegraphics[width=1\textwidth]{Graphics/Naive.png}
\end{figure}
\end{frame}


\begin{frame}{The naive estimator: Example}
\begin{table}[]
\caption{Effect of high education on income}
\begin{tabular}{ccc}
\hline
\textbf{}                     & \textbf{Y\textsubscript{i}\textsuperscript{0}} & \textbf{Y\textsubscript{i}\textsuperscript{1}} \\ \hline
\textbf{D\textsubscript{i}=0} & {\color[HTML]{000000} 10 \euro/h}                  & {\color[HTML]{000000} 20 \euro/h}                   \\
\textbf{D\textsubscript{i}=1} & {\color[HTML]{000000} 15 \euro/h}                  & {\color[HTML]{000000} 30 \euro/h}                  \\ \hline
\end{tabular}
\end{table}
Calculation of the effect of high education on income:\\
\begin{itemize}
  \item \textcolor{red}{Naive estimator = 30 \euro/h - 10 \euro/h = \textbf{20 \euro/h}}
  \item ATT = 30 \euro/h - 15 \euro/h = \textcolor{green}{\textbf{15 \euro/h}}
  \item ATNT = 20 \euro/h - 10 \euro/h = \textcolor{green}{\textbf{10 \euro/h}}
  \item ATE = 15 \euro/h$\times \pi$ + 10 \euro/h $\times (1-\pi)$ = \textcolor{green}{\textbf{12.5 \euro/h}}
\end{itemize}
\end{frame}


\begin{frame}{Bias of the naive estimator}
\begin{itemize}
  \item In most of the real world scenarios, the naive estimator does not provide the true value of any causal effect. This means the result of the Naive Estimator is \textit{biased}! 
  \item This distortion results from the so-called \textbf{baseline difference}. This is the difference between the technically required but counterfactual potential outcome and the observable potential outcome used
\end{itemize}
\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{Graphics/BaselineDifferences.png}
\end{figure}
\end{frame}


\begin{frame}{Bias decomposition: NaivE-ATT I}
\textit{Bias decomposition of the naive estimator (regarding ATT):}
\begin{align*}
NaivE &= E(Y\textsubscript{i}\textsuperscript{1}\vert D\textsubscript{i}=1)-E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=0) \\
&= ATT + \underbrace{(\underbrace{E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=1)}_\text{unobservable} - E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=0)}_\text{baseline difference})
\end{align*}
\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{Graphics/Naive_ATT_Baseline.png}
\end{figure}
\end{frame}

\begin{frame}{Bias decomposition: NaivE-ATT II}
\textbf{Calculation of the ATT from the naive estimator and the baseline difference.}
\\[1em]
Changing the formula of NaivE to ATT: \\
\begin{align*}
ATT = NaivE - \underbrace{(\underbrace{E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=1)}_\text{unobservable}- E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=0))}_\text{baseline difference}
\end{align*}
\\[1em]
Application:\\
In the example the baseline difference is (15 Euro/h - 10 Euro/h =) \textbf{5 Euro/h}. Naive estimator minus blaseline difference (20 Euro/h - 5 Euro/h) equals the true value of the ATT (15 Euro/h)
\end{frame}



\begin{frame}{Bias decomposition: NaivE-ATNT I}
\textit{Bias decomposition of the naive estimator (regarding ATNT):}
\begin{align*}
NaivE &= E(Y\textsubscript{i}\textsuperscript{1}\vert D\textsubscript{i}=1)-E(Y\textsubscript{i}\textsuperscript{0} \vert D\textsubscript{i}=0) \\
&= ATNT + (\underbrace{E(Y\textsubscript{i}\textsuperscript{1} \vert D\textsubscript{i}=1) - \underbrace{E(Y\textsubscript{i}\textsuperscript{1} \vert D\textsubscript{i}=0)}_\text{unobservable})}_\text{baseline difference}
\end{align*}
\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{Graphics/Naive_ATNT_Baseline.png}
\end{figure}
\end{frame}

\begin{frame}{Bias decomposition: NaivE-ATNT II}
\textbf{Calculation of the ATT from the naive estimator and the baseline difference.}
\\[1em]
Changing the formula of NaivE to ATNT: \\
\begin{align*}
ATNT = NaivE - \underbrace{(E(Y\textsubscript{i}\textsuperscript{1} \vert D\textsubscript{i}=1) - \underbrace{E(Y\textsubscript{i}\textsuperscript{1} \vert D\textsubscript{i}=0)}_\text{unobservable})}_\text{baseline difference}
\end{align*}
\\[1em]
Application:\\
In the example the baseline difference is (30 Euro/h - 20 Euro/h =) \textbf{10 Euro/h}. Naive estimator minus blaseline difference (20 Euro/h - 10 Euro/h) equals the true value of the ATNT (10 Euro/h)
\end{frame}


\begin{frame}{Violation of the ignorability assumption}
\textbf{Reason for the bias of the naive estimator} 
\\
$\rightarrow$ Violation of the \textit{Ignorability Assumption (IA)} 
\\[1em]
\textbf{IA:} (Y\textsuperscript{0},Y\textsuperscript{1}) $\upmodels$ D 
\\
$\Rightarrow$ E(Y\textsuperscript{0}$\vert$D=0) = E(Y\textsuperscript{0}$\vert$D=1) = E(Y\textsuperscript{0}) 
\\
$\Rightarrow$ E(Y\textsuperscript{1}$\vert$D=0) = E(Y\textsuperscript{1}$\vert$D=1) = E(Y\textsuperscript{1})

\begin{itemize}
\item Assignment of the treatment status D is independent of the potential outcome
\item Caution: The ignorability assumption is often not fulfilled (due to a lack of randomization), since features in the background influence both individuals assignment of the treatment group and their potential outcomes $\rightarrow$ distortion of the naive estimator
\end{itemize}
\end{frame}


\begin{frame}{Ignorability assumption}
\textbf{Implication of the ignorability assumption}
\\[1em]
\begin{itemize}
  \item If it applies, the potential outcomes are independent of treatment status D.\\
\end{itemize}
Thus applies:
\\
E(Y\textsuperscript{0}$\vert$D=1) = E(Y\textsuperscript{0}$\vert$D=0) and 
\\
E(Y\textsuperscript{1}$\vert$D=1) = E(Y\textsuperscript{1}$\vert$D=0)
\\[1em]
\begin{itemize}
\item From this, in turn, it follows that the baseline difference (the bias of NaiveS) is: (E[Y\textsubscript{i}\textsuperscript{0}$\vert$D\textsubscript{i}=1] - E[Y\textsubscript{i}\textsuperscript{0}$\vert$D\textsubscript{i}=0] =) 0 
\item \textit{The NaiveS thus results in the true average causal effect of interest (ATT,ATNT or ATE)}
\end{itemize}

\end{frame}


\begin{frame}{Ignorability assumption}
\textbf{Under which conditions is the ignorability assumption valid?}
\begin{enumerate}
  \item Treatment status D is in fact independent of the potential outcomes
  \item Treatment status D is after conditioning a set of variables Z independent of the potential outcomes $\rightarrow$ \textit{Conditional Ignorability Assumption (CIA)}
\end{enumerate}

\textbf{How can these conditions be verified?}
\begin{enumerate}
  \item With \textit{Directed Acyclic Graphs (DAGs)} (1) and (2) can be checked
  \item For (2), the required set of variables Z can be derived using DAGs
\end{enumerate}

\end{frame}


\section{Directed Acyclic Graphs (DAGs)} % Wichtig für Inhaltsverzeichnis

\begin{frame}{Directed Acyclic Graphs (DAGs)}
\textbf{Pearl 1995: Causal diagrams for empirical research}
\begin{itemize}
  \item Graphical tool to represent qualitative assumptions about causal relationships 
  \item It is possible to derive causal conclusions from these assumptions and data
\end{itemize}

\textbf{Notation}
\begin{itemize}
  \item Each point of the DAG represents a features/variable whose name is given
  \item Filled points represent \textit{observed} features/variables
  \item Unfilled points represent \textit{unobserved} features/variables
  \item One-sided arrows postulate a directed causal effect \textit{(theoretically or based on empirical causal analysis)}
\end{itemize}
\end{frame} 


\begin{frame}{Directed Acyclic Graphs (DAGs)}
\textbf{Definitions}
\begin{itemize}
  \item \textbf{Path:} Every (uninterrupted) connection between two points, \textit{regardless of the direction of the arrow}
  \item \textbf{Causal Path:} Every (uninterrupted) connection between two points, \textit{with clear arrow direction}
  \item \textbf{Directed Graph:} Every connection between two variables is a one-sided arrow
  \item \textbf{Acyclic Graph:} There are no loops of causal paths
  \item \textbf{Back-door Path:} A path that connects D and Y and in which an arrowhead points to D.
  \item \textbf{Collider:} A variable pointed to by two arrows
  \item \textbf{(Un-)Blocked Path:} A path is \textit {blocked} if there is at least one collider on it, otherwise this is \textit{unblocked}.
  \item \textbf{Blocking Paths:} A path can be blocked by a variable on this path that is not a collider
\end{itemize}
\end{frame} 


\begin{frame}{Directed Acyclic Graphs (DAGs)}
\textbf{Back-door criterion}
\\[1em]
A set of variables Z fulfills the \textit{back-door criterium} if:
\begin{itemize}
  \item No variable in Z is causally influenced by D.
  \item By Z every \textit{unblocked path} between D and Y becomes blocked
\end{itemize}
If the back-door criterion is met, the CIA is satisfied and a causal effect identified
\end{frame} 



%------------------------------------------------------%
%--------------------- DAG I --------------------------%
%------------------------------------------------------%

\begin{frame}{DAG Examples I: Overview}
\textbf{No Confounding}
\begin{figure}
\includegraphics[width=0.8\textwidth]{{Graphics/1.NoConfounding.png}}
\end{figure}
Question:
\begin{enumerate}
\item What is the causal path of interest?
\item What is/are the back-door path(s)? Are they open? How to block them?
\end{enumerate}
\\[1em]
$\rightarrow$ Is the result of the naive estimator the true causal effect?
\end{frame}

\begin{frame}{DAG Examples I: Paths}
\begin{figure}
\includegraphics[width=0.8\textwidth]{{Graphics/1.NoConfounding.png}}
\end{figure}
\textbf{Paths:}
\begin{itemize}
\item Causal path: D $\rightarrow$ Y
\end{itemize}

\textbf{CIA satisfaction:}
\begin{itemize}
\item Automatically satisfied because there are no back-door path 
\end{itemize}
\end{frame}


\begin{frame}{DAG Examples I: Scatterplot}
\begin{figure}
<<ExamplesIScatterplot, fig=TRUE, echo=FALSE>>=

#Paths between the Variables D & Y
    # Causal path: D -(+)-> Y

  #Creation of the data
    set.seed(548)
    D <- rnorm(5000, mean=7, sd=3)
    
    set.seed(206)
    Y <- D*2 + rnorm(5000, mean=0, sd=10)
    
    data.1 <- data.frame(D=D, Y=Y)
    
  #Plotting data & estimating correlations
    scatter.smooth(x=data.1$D, y=data.1$Y, main="D -> Y") # scatter plot with smooth curve (computed by loess)
@
\end{figure}
\end{frame}


\begin{frame}[fragile]{DAG Examples I: Regression result}
<<ExamplesIRegression, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.1<- lm(Y ~ D, data.1) # fitting the regression model (adjustet)
    xtable(summary(fit.1), caption = "Regression: lm(Y \\textasciitilde ~D)") # beta-coefficients & p-value
    xtable(confint(fit.1,'D', level = 0.95), caption = "95-Percent confidence interval") # confidence interval(s)   
@
\end{frame}



%------------------------------------------------------%
%--------------------- DAG II -------------------------%
%------------------------------------------------------%


\begin{frame}{DAG Examples II: (Partially) Covered}
\\[1em]
\begin{figure}
\includegraphics[width=0.6\textwidth]{Graphics/2.SimpleConfounding-Covered.png}
\end{figure}
Question:
\begin{enumerate}
\item What is the causal path of interest?
\item What is/are the back-door path(s)? Are they open? How to block them?
\end{enumerate}
\\[1em]
$\rightarrow$ Is the result of the naive estimator the true causal effect?
\end{frame}


\begin{frame}{DAG Examples II: Paths}
\begin{figure}
\includegraphics[width=0.8\textwidth]{{Graphics/2.SimpleConfounding-Covered.png}}
\end{figure}
\textbf{Paths:}
\begin{itemize}
\item Causal path: D $\rightarrow$ Y
\item Back-door path: D $\leftarrow$ C $\rightarrow$ Y
\end{itemize}

\textbf{CIA satisfaction:}
\begin{itemize}
\item Z1 = \{C\}
\end{itemize}
\end{frame}


\begin{frame}{DAG Examples II: Scatterplot}
\begin{figure}
<<ExamplesIIScatterplot, fig=TRUE, echo=FALSE>>=

  #Paths between the Variables D & Y
    # Causal path: D -(+)-> Y
    # 1. Back-door path: D <-(-)- Z -(+)-> Y
    
      # -> Causal Path is (partially) covered 
    
    #Creation of the data
      set.seed(548)
      C <- rnorm(10000, mean=4, sd=3.5)    
      
      set.seed(678)
      D <- C*(-1) + rnorm(10000, mean=7, sd=3)
      
      set.seed(206)
      Y <- D*2 + C*3.5 + rnorm(10000, mean=0, sd=15)
      
      data.2 <- data.frame(C=C, D=D, Y=Y)
    
  #Plotting data & estimating correlations
    scatter.smooth(x=data.2$D, y=data.2$Y, main="D -> Y") # scatter plot with smooth curve (computed by loess)
@
\end{figure}
\end{frame}


\begin{frame}[fragile]{DAG Examples II: Regression result, NaivE}
<<ExamplesIIRegressionNaivE, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.2u<- lm(Y ~ D, data.2) # fitting the regression model (adjustet)
    print(xtable(summary(fit.2u), caption = "Regression: lm(Y \\textasciitilde ~D)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.2u,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D)"),size="\\small") # confidence interval(s)   
@
\end{frame}

\begin{frame}[fragile]{DAG Examples II: Regression result, CIA}
\textbf{Usage of Z1 to satisfy CIA}
<<ExamplesIIRegressionCIA, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.2a<- lm(Y ~ D + C, data.2) # fitting the regression model (adjustet)
    print(xtable(summary(fit.2a), caption = "Regression: lm(Y \\textasciitilde ~D + C1)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.2a,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D + C1)"),size="\\small") # confidence interval(s) 
@
\end{frame}

%------------------------------------------------------%
%--------------------- DAG III ------------------------%
%------------------------------------------------------%

\begin{frame}{DAG Examples III: Oversized}
\\[1em]
\begin{figure}
\includegraphics[width=0.6\textwidth]{Graphics/3.SimpleConfounding-Oversized.png}
\end{figure}
Question:
\begin{enumerate}
\item What is the causal path of interest?
\item What is/are the back-door path(s)? Are they open? How to block them?
\end{enumerate}
\\[1em]
$\rightarrow$ Is the result of the naive estimator the true causal effect?
\end{frame}


\begin{frame}{DAG Examples III: Paths}
\begin{figure}
\includegraphics[width=0.8\textwidth]{{Graphics/3.SimpleConfounding-Oversized.png}}
\end{figure}
\textbf{Paths:}
\begin{itemize}
\item Causal path: D $\rightarrow$ Y
\item Back-door path: D $\leftarrow$ C $\rightarrow$ Y
\end{itemize}

\textbf{CIA satisfaction:}
\begin{itemize}
\item Z1 = \{C\}
\end{itemize}
\end{frame}


\begin{frame}{DAG Examples III: Scatterplot}
\begin{figure}
<<ExamplesIIIScatterplot, fig=TRUE, echo=FALSE>>=

  #Paths between the Variables D & Y
      # Causal path: D -(+)-> Y
      # 1. Back-door path: D <-(+)- C -(+)-> Y (back-door path) 
      
      # -> Causal path appears oversized
      
    #Creation of the data
      set.seed(548)
      C <- rnorm(10000, mean=4, sd=3.5)    
      
      set.seed(303)
      D <- C*(+1) + rnorm(10000, mean=7, sd=3)
      
      set.seed(206)
      Y <- D*2 + C*3.5 + rnorm(10000, mean=0, sd=20)
      
      data.3 <- data.frame(C=C, D=D, Y=Y)
    
  #Plotting data & estimating correlations
    scatter.smooth(x=data.3$D, y=data.3$Y, main="D -> Y") # scatter plot with smooth curve (computed by loess)
@
\end{figure}
\end{frame}


\begin{frame}[fragile]{DAG Examples III: Regression result, NaivE}
<<ExamplesIIIRegressionNaivE, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.3u<- lm(Y ~ D, data.3) # fitting the regression model (adjustet)
    print(xtable(summary(fit.3u), caption = "Regression: lm(Y \\textasciitilde ~D)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.3u,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D)"),size="\\small") # confidence interval(s)   
@
\end{frame}

\begin{frame}[fragile]{DAG Examples III: Regression result, CIA}
\textbf{Usage of Z1 to satisfy CIA}
<<ExamplesIIIRegressionCIA, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.3a<- lm(Y ~ D + C, data.3) # fitting the regression model (adjustet)
    print(xtable(summary(fit.3a), caption = "Regression: lm(Y \\textasciitilde ~D + C1)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.3a,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D + C1)"),size="\\small") # confidence interval(s) 
@
\end{frame}



%------------------------------------------------------%
%--------------------- DAG IV -------------------------%
%------------------------------------------------------%


\begin{frame}{DAG Examples IV}
\\[1em]
\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{Graphics/4.LongBack-doorPath-Oversized.png}
\end{figure}
Question:
\begin{enumerate}
\item What is the causal path of interest?
\item What is/are the back-door path(s)? Are they open? How to block them?
\end{enumerate}
\\[1em]
$\rightarrow$ Is the result of the naive estimator the true causal effect?
\end{frame}


\begin{frame}{DAG Examples IV: Paths}
\begin{figure}
\includegraphics[width=0.8\textwidth]{{Graphics/4.LongBack-doorPath-Oversized.png}}
\end{figure}
\textbf{Paths:}
\begin{itemize}
\item Causal path: D $\rightarrow$ Y
\item Back-door path: D $\leftarrow$ C\textsubscript{1} $\rightarrow$ C\textsubscript{2} $\rightarrow$ Y
\end{itemize}

\textbf{CIA satisfaction:}
\begin{itemize}
\item Z1 = \{C\textsubscript{1}\} or
\item Z2 = \{C\textsubscript{2}\}
\end{itemize}
\end{frame}


\begin{frame}{DAG Examples IV: Scatterplot}
\begin{figure}
<<ExamplesIVScatterplot, fig=TRUE, echo=FALSE>>=

    #Paths between the Variables D & Y
      # Causal path: D -(+)-> Y
      # 1. Back-door path: D <-(+)- C1 -(+)-> C2 -(+)-> Y (back-door path)
      
      # -> Causal path appears oversized
      
    #Creation of the data
      set.seed(548)
      C1 <- rnorm(10000, mean=4, sd=3.5)  
      
      set.seed(449)
      C2 <- C1*(+0.5) + rnorm(10000, mean=1, sd=2.5)       
      
      set.seed(303)
      D <- C1*(+1) + rnorm(10000, mean=7, sd=3)
      
      set.seed(206)
      Y <- D*2 + C2*1.5 + rnorm(10000, mean=0, sd=10)
      
      data.4 <- data.frame(C1=C1, C2=C2, D=D, Y=Y)
    
  #Plotting data & estimating correlations
    scatter.smooth(x=data.4$D, y=data.4$Y, main="D -> Y") # scatter plot with smooth curve (computed by loess)
@
\end{figure}
\end{frame}


\begin{frame}[fragile]{DAG Examples IV: Regression result, NaivE}
<<ExamplesIVRegressionNaivE, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.4u<- lm(Y ~ D, data.4) # fitting the regression model (adjustet)
    print(xtable(summary(fit.4u), caption = "Regression: lm(Y \\textasciitilde ~D)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.4u,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D)"),size="\\small") # confidence interval(s)   
@
\end{frame}

\begin{frame}[fragile]{DAG Examples IV: Regression result, CIA I}
\textbf{Usage of Z1 to satisfy CIA}
<<ExamplesIVRegressionCIA1, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.4a1<- lm(Y ~ D + C1, data.4) # fitting the regression model (adjustet)
    print(xtable(summary(fit.4a1), caption = "Regression: lm(Y \\textasciitilde ~D + C1)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.4a1,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D + C1)"),size="\\small") # confidence interval(s) 
@
\end{frame}

\begin{frame}[fragile]{DAG Examples IV: Regression result, CIA II}
\textbf{Usage of Z2 to satisfy CIA}
<<ExamplesIVRegressionCIA2, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.4a2<- lm(Y ~ D + C2, data.4) # fitting the regression model (adjustet)
    print(xtable(summary(fit.4a2), caption = "Regression: lm(Y \\textasciitilde ~D + C2)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.4a2,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D + C2)"),size="\\small") # confidence interval(s) 
@
\end{frame}

%------------------------------------------------------%
%--------------------- DAG V --------------------------%
%------------------------------------------------------%

\begin{frame}{DAG Examples V: (Partially) Covered}
\\[1em]
\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{Graphics/5.TwoBack-doorpaths-Covered.png}
\end{figure}
Question:
\begin{enumerate}
\item What is the causal path of interest?
\item What is/are the back-door path(s)? Are they open? How to block them?
\end{enumerate}
\\[1em]
$\rightarrow$ Is the result of the naive estimator the true causal effect?
\end{frame}


\begin{frame}{DAG Examples V: Paths}
\begin{figure}
\includegraphics[width=0.5\textwidth]{{Graphics/5.TwoBack-doorpaths-Covered.png}}
\end{figure}
\textbf{Paths:}
\begin{itemize}
\item Causal path: D $\rightarrow$ Y
\item 1. Back-door path: D $\leftarrow$ C\textsubscript{1} $\rightarrow$ C\textsubscript{2} $\rightarrow$ C\textsubscript{3} $\rightarrow$ Y
\item 2. Back-door path: D $\leftarrow$ C\textsubscript{1} $\rightarrow$ C\textsubscript{2} $\rightarrow$ C\textsubscript{4} $\rightarrow$ Y
\end{itemize}

\textbf{CIA satisfaction:}
\begin{itemize}
\item Z1 = \{C\textsubscript{1}\} or
\item Z2 = \{C\textsubscript{2}\} or
\item Z3 = \{C\textsubscript{3}, C\textsubscript{4}\}
\end{itemize}
\end{frame}


\begin{frame}{DAG Examples V: Scatterplot}
\begin{figure}
<<ExamplesVScatterplot, fig=TRUE, echo=FALSE>>=

    #Paths between the Variables D & Y
      # Causal path: D -(+)-> Y
      # 1. Back-door path: D <-(+)- C1 -(+)-> C2 -(+)-> C3 -(-)-> Y (1. back-door path)  
      # 2. Back-door path: D <-(+)- C1 -(+)-> C2 -(-)-> C4 -(-)-> Y (2. back-door path)  
      
      # -> Causal path is (partially) covered
      
    #Creation of the data
      set.seed(548)
      C1 <- rnorm(10000, mean=4, sd=3.5)  
      
      set.seed(449)
      C2 <- C1*(+1.5) + rnorm(10000, mean=1, sd=2.5)
      
      set.seed(329)
      C3 <- C2*(+2) + rnorm(10000, mean=1.5, sd=1.5)  
      
      set.seed(741)
      C4 <- C2*(-0.5) + rnorm(10000, mean=2.5, sd=4)      
      
      set.seed(303)
      D <- C1*(+1) + rnorm(10000, mean=7, sd=3)
      
      set.seed(206)
      Y <- D*2 + C3*(-1.5) + C4*(-1) + rnorm(10000, mean=0, sd=30)
      
      data.5 <- data.frame(C1=C1, C2=C2, C3=C3, C4=C4, D=D, Y=Y)
    
  #Plotting data & estimating correlations
    scatter.smooth(x=data.5$D, y=data.5$Y, main="D -> Y") # scatter plot with smooth curve (computed by loess)
@
\end{figure}
\end{frame}


\begin{frame}[fragile]{DAG Examples V: Regression result, NaivE}
<<ExamplesVRegressionNaivE, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.5u<- lm(Y ~ D, data.5) # fitting the regression model (adjustet)
    print(xtable(summary(fit.5u), caption = "Regression: lm(Y \\textasciitilde ~D)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.5u,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D)"),size="\\small") # confidence interval(s)   
@
\end{frame}

\begin{frame}[fragile]{DAG Examples V: Regression result, CIA I}
\textbf{Usage of Z1 to satisfy CIA}
<<ExamplesVRegressionCIA1, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.5a1<- lm(Y ~ D + C1, data.5) # fitting the regression model (adjustet)
    print(xtable(summary(fit.5a1), caption = "Regression: lm(Y \\textasciitilde ~D + C1)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.5a1,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D + C1)"),size="\\small") # confidence interval(s) 
@
\end{frame}

\begin{frame}[fragile]{DAG Examples V: Regression result, CIA II}
\textbf{Usage of Z2 to satisfy CIA}
<<ExamplesVRegressionCIA2, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.5a2<- lm(Y ~ D + C2, data.5) # fitting the regression model (adjustet)
    print(xtable(summary(fit.5a2), caption = "Regression: lm(Y \\textasciitilde ~D + C2)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.5a2,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D + C2)"),size="\\small") # confidence interval(s) 
@
\end{frame}

\begin{frame}[fragile]{DAG Examples V: Regression result, CIA III}
\textbf{Usage of Z3 to satisfy CIA}
<<ExamplesVRegressionCIA3, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.5a3<- lm(Y ~ D + C3 + C4, data.5) # fitting the regression model (adjustet)
    print(xtable(summary(fit.5a3), caption = "Regression: lm(Y \\textasciitilde ~D + C3 + C4)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.5a3,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D + C3 + C4)"),size="\\small") # confidence interval(s) 
@
\end{frame}



%------------------------------------------------------%
%--------------------- DAG VI -------------------------%
%------------------------------------------------------%

\begin{frame}{DAG Examples VI}
\\[1em]
\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{Graphics/6.TwoBack-doorpaths-Covered(missings).png}
\end{figure}
Question:
\begin{enumerate}
\item What is the causal path of interest?
\item What is/are the back-door path(s)? Are they open? How to block them?
\end{enumerate}
\\[1em]
$\rightarrow$ Is the result of the naive estimator the true causal effect?
\end{frame}


\begin{frame}{DAG Examples VI: Paths}
\begin{figure}
\includegraphics[width=0.5\textwidth]{{Graphics/6.TwoBack-doorpaths-Covered(missings).png}}
\end{figure}
\textbf{Paths:}
\begin{itemize}
\item Causal path: D $\rightarrow$ Y
\item 1. Back-door path: D $\leftarrow$ C\textsubscript{1} $\rightarrow$ C\textsubscript{2} $\rightarrow$ C\textsubscript{3} $\rightarrow$ Y
\item 2. Back-door path: D $\leftarrow$ C\textsubscript{1} $\rightarrow$ C\textsubscript{2} $\rightarrow$ C\textsubscript{4} $\rightarrow$ Y
\end{itemize}

\textbf{CIA satisfaction:}
\begin{itemize}
\item Only Z3 = \{C\textsubscript{3}, C\textsubscript{4}\} can be used because it is observed
\end{itemize}
\end{frame}


%------------------------------------------------------%
%--------------------- DAG VII ------------------------%
%------------------------------------------------------%

\begin{frame}{DAG Examples VII}
\\[1em]
\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{Graphics/6.TwoBack-doorpaths-Covered(moremissings).png}
\end{figure}
Question:
\begin{enumerate}
\item What is the causal path of interest?
\item What is/are the back-door path(s)? Are they open? How to block them?
\end{enumerate}
\\[1em]
$\rightarrow$ Is the result of the naive estimator the true causal effect?
\end{frame}


\begin{frame}{DAG Examples VII: Paths}
\begin{figure}
\includegraphics[width=0.5\textwidth]{{Graphics/6.TwoBack-doorpaths-Covered(moremissings).png}}
\end{figure}
\textbf{Paths:}
\begin{itemize}
\item Causal path: D $\rightarrow$ Y
\item 1. Back-door path: D $\leftarrow$ C\textsubscript{1} $\rightarrow$ C\textsubscript{2} $\rightarrow$ C\textsubscript{3} $\rightarrow$ Y
\item 2. Back-door path: D $\leftarrow$ C\textsubscript{1} $\rightarrow$ C\textsubscript{2} $\rightarrow$ C\textsubscript{4} $\rightarrow$ Y
\end{itemize}

\textbf{CIA satisfaction:}
\begin{itemize}
\item Not all back-door paths can be closed
\item CIA is only partially met by Z4 = \{C\textsubscript{4}\}
\item The estimate will contain a bias despite the closing of one back door path
\item The bias is induced by the back-door path that is still open
\end{itemize}
\end{frame}


\begin{frame}[fragile]{DAG Examples VII: Regression result, NaivE}
<<ExamplesVIIRegressionNaivE, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.5u<- lm(Y ~ D, data.5) # fitting the regression model (adjustet)
    print(xtable(summary(fit.5u), caption = "Regression: lm(Y \\textasciitilde ~D)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.5u,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D)"),size="\\small") # confidence interval(s)   
@
\end{frame}

\begin{frame}[fragile]{DAG Examples VII: Regression result, CIA I}
\textbf{Usage of Z4 to partially satisfy CIA}
<<ExamplesVIIRegressionCIA1, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.7a1<- lm(Y ~ D + C4, data.5) # fitting the regression model (adjustet)
    print(xtable(summary(fit.7a1), caption = "Regression: lm(Y \\textasciitilde ~D + C3)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.7a1,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D + C4)"),size="\\small") # confidence interval(s) 
@
\end{frame}


%------------------------------------------------------%
%--------------------- DAG VIII -----------------------%
%------------------------------------------------------%

\begin{frame}{DAG Examples VIII}
\\[1em]
\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{Graphics/7.Collider.png}
\end{figure}
Question:
\begin{enumerate}
\item What is the causal path of interest?
\item What is/are the back-door path(s)? Are they open? How to block them?
\end{enumerate}
\\[1em]
$\rightarrow$ Is the result of the naive estimator the true causal effect?
\end{frame}


\begin{frame}{DAG Examples VIII: Paths}
\begin{figure}
\includegraphics[width=0.5\textwidth]{{Graphics/7.Collider.png}}
\end{figure}
\textbf{Paths:}
\begin{itemize}
\item Causal path: D $\rightarrow$ Y
\item 1. Back-door path: D $\leftarrow$ C\textsubscript{1} $\rightarrow$ C\textsubscript{2} $\leftarrow$ C\textsubscript{3} $\rightarrow$ Y
\end{itemize}

\textbf{CIA satisfaction:}
\begin{itemize}
\item Automatically satisfied because of the collier on back-door path 
\end{itemize}
\end{frame}


\begin{frame}{DAG Examples VIII: Scatterplot}
\begin{figure}
<<ExamplesVIIIScatterplot, fig=TRUE, echo=FALSE>>=

    #Paths between the Variables D & Y
    # Causal path: D -(+)-> Y
    # 1. Back-door path: D <-(-)- C1 -(-)-> C2 <-(-)- C3 -(-)-> Y
    
    # -> 
    
    #Creation of the data
    set.seed(181)
    C1 <- rnorm(10000, mean=2.5, sd=1) 
    
    set.seed(195)
    C3 <- rnorm(10000, mean=2, sd=1.5) 
    
    set.seed(318)
    C2 <- C1*(-2) + C3*(-1.5) + rnorm(10000, mean=2, sd=3) 
    
    set.seed(548)
    D <- C1*(2) + rnorm(10000, mean=4, sd=2.5)    
    
    set.seed(206)
    Y <- D*1.5 + C3*(-4) + rnorm(10000, mean=0, sd=2.5)
    
    data.9 <- data.frame(C1=C1, C2=C2, C3=C3, D=D, Y=Y)
    
  #Plotting data & estimating correlations
     scatter.smooth(x=data.9$D, y=data.9$Y, main="D -> M -> Y") # scatter plot with smooth curve (computed by loess)
@
\end{figure}
\end{frame}


\begin{frame}[fragile]{DAG Examples VIII: Regression result, NaivE}
<<ExamplesVIIIRegressionNaivE, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.9u<- lm(Y ~ D, data.9) # fitting the regression model (adjustet)
    print(xtable(summary(fit.9u), caption = "Regression: lm(Y \\textasciitilde ~D)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.9u,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D)"),size="\\small") # confidence interval(s)   
@
\end{frame}

\begin{frame}[fragile]{DAG Examples VIII: Regression result, wrong control}
\textbf{Usage of Z1 to satisfy CIA}
<<ExamplesVIIIRegressionCIA1, results='asis', echo=FALSE>>=
library(xtable)
  #Regression analysis  
    fit.9ca <- lm(Y ~ D + C2, data.9) # fitting the regression model (adjustet)
    print(xtable(summary(fit.9ca), caption = "Regression: lm(Y \\textasciitilde ~D + C1)"),size="\\small") # beta-coefficients & p-value
    print(xtable(confint(fit.9ca,'D', level = 0.95), caption = "95-Percent confidence interval: lm(Y \\textasciitilde ~D + C2)"),size="\\small") # confidence interval(s) 
@
\end{frame}


%-------------------------------------------------------------%
%---- Experimental vs. non-experimental designs --------------%
%-------------------------------------------------------------%

\section{Experimental vs. non-experimental designs} % Wichtig für Inhaltsverzeichnis

\begin{frame}{Experimental designs}
  \begin{itemize}
  \item The central feature of \textbf{experimental designs} is the random distribution of the observations (e.g. test subjects) between a treatment group and a control group (\textit{randomization})
  \item Due to the randomization, these are often seen as an ideal design for drawing causal inferences because the \textbf{IA is automatically satisfied}
  \item \textbf{Problem:} Often experimental designs cannot be implemented due to \textit{practical and ethical problems}
  \item In addition, experiments can have problems \textit{internal and external validity}
  \end{itemize}
\end{frame}


\begin{frame}{Non-experimental designs}
  \begin{itemize}
    \item Frequent use in the social sciences of non-experimental methods of causal analysis based on observational data
    \item Data sources are e.g. general population surveys such as ALLBUS, SOEP or ESS
    \item \textbf{Problems:}
      \begin{itemize}  
        \item Non-random selection
        \item CIA/IA needs to be satisfied
      \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{(Temporal) dataset structure I}
\textbf{Cross-sectional data}
  \begin{itemize}
    \item No time dimension in the outcome variable (Y): measurement only once at time t1
    \item Treatment variable (D) is also recorded at the same point in time t1 ... \\[0.5em]
      \begin{itemize}  
        \item (A) ... but based on theoretical reasons it can be assumed to take place earlier, even if the measurement relates to time t1. (\textit{Example: D:father's level of education, Y:respondent's income}) \\[0.5em]
        \item (B) ... but can, as a retrospective question, relate to an earlier point in time t0 (or period)
      \end{itemize}
  \end{itemize}
\end{frame}


\begin{frame}{(Temporal) dataset structure II}
\textbf{Longitudinal data}
  \begin{itemize}
    \item At least two measurements of the Y variable in time to capture changes in Y.
    \item Additional condition for the implementation of a "fixed-effect" logic: \\
    At least one measurement of the Y variable must relate to a point in time before the treatment (= change over time in the D variable of interest) and at least one measurement of the Y variable must relate to a point in time after the treatment
  \end{itemize}
\end{frame}



%Aufgabe zur nächsten Sitzung
\begin{frame}{Task for the next meeting}
\begin{itemize}
  \item Search for possible confounders of the chosen connections. \\[1em]
  \item Include this in the already created document. \\[1em]
  \item Inclusion of the confounder(s) in the regression analysis as control variable(s). \\[1em]
\end{itemize}
\end{frame} 



%Noch Fragen
\begin{frame}

\center{Do you still have any questions?}
  
\end{frame} 


\end{document}